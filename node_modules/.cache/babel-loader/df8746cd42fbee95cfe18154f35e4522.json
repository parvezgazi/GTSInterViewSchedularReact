{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\nvar DragAndDrop = /** @class */function (_super) {\n  __extends(DragAndDrop, _super);\n  function DragAndDrop() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.widthUptoCursorPoint = 0;\n    _this.heightUptoCursorPoint = 0;\n    _this.cursorPointIndex = 0;\n    _this.isHeaderRows = false;\n    _this.isTimelineDayProcess = false;\n    _this.widthPerMinute = 0;\n    _this.heightPerMinute = 0;\n    _this.minDiff = 0;\n    _this.isStepDragging = false;\n    _this.isMorePopupOpened = false;\n    _this.isAllDayDrag = false;\n    _this.isMultiSelect = false;\n    _this.multiData = [];\n    _this.updatedData = [];\n    _this.swagData = [];\n    _this.startTime = 0;\n    _this.isAllDayTarget = false;\n    _this.targetTd = null;\n    _this.isCursorAhead = false;\n    return _this;\n  }\n  DragAndDrop.prototype.wireDragEvent = function (element) {\n    new Draggable(element, {\n      abort: '.' + cls.EVENT_RESIZE_CLASS,\n      clone: true,\n      isDragScroll: true,\n      enableTapHold: this.parent.isAdaptive,\n      enableTailMode: this.parent.eventDragArea ? true : false,\n      cursorAt: this.parent.eventDragArea ? {\n        left: -20,\n        top: -20\n      } : {\n        left: 0,\n        top: 0\n      },\n      dragArea: this.dragArea,\n      dragStart: this.dragStart.bind(this),\n      drag: this.drag.bind(this),\n      dragStop: this.dragStop.bind(this),\n      enableAutoScroll: false,\n      helper: this.dragHelper.bind(this),\n      queryPositionInfo: this.dragPosition.bind(this)\n    });\n  };\n  DragAndDrop.prototype.setDragArea = function () {\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n    this.dragArea = this.parent.eventDragArea && dragElement ? dragElement : this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n  };\n  DragAndDrop.prototype.dragHelper = function (e) {\n    var _this = this;\n    this.setDragActionDefaultValues();\n    this.actionObj.element = e.element;\n    this.actionObj.action = 'drag';\n    var elements = [];\n    if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 || this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1) {\n      elements = [e.element];\n    } else {\n      elements = this.parent.selectedElements;\n      this.isMultiSelect = true;\n    }\n    elements.forEach(function (ele) {\n      var cloneElement = _this.createCloneElement(ele);\n      if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n        _this.actionObj.clone = cloneElement;\n        if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' && _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() && !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n          setStyleAttribute(_this.actionObj.clone, {\n            cursor: 'move',\n            left: '0%',\n            right: '0%',\n            width: '100%'\n          });\n        }\n        _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n      }\n      _this.actionObj.cloneElement.push(cloneElement);\n      _this.actionObj.originalElement.push(ele);\n    });\n    return this.actionObj.clone;\n  };\n  DragAndDrop.prototype.dragPosition = function (e) {\n    if (this.parent.eventDragArea) {\n      return {\n        left: e.left,\n        top: e.top\n      };\n    }\n    var cellHeight = this.actionObj.cellHeight / this.actionObj.slotInterval * this.actionObj.interval;\n    var leftValue = formatUnit(0);\n    if (this.parent.currentView === 'Month') {\n      leftValue = e.left;\n    }\n    var cloneRight;\n    if (this.isStepDragging) {\n      cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n    } else {\n      cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n    }\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n    if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl && this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n      this.isCursorAhead = true;\n    }\n    if (this.parent.activeView.isTimelineView()) {\n      leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n    }\n    var topValue;\n    if (this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable || !isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      topValue = formatUnit(this.actionObj.clone.offsetTop);\n    } else if (this.parent.currentView === 'Month') {\n      topValue = formatUnit(0);\n    } else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n      topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n        right: this.parent.enableRtl && formatUnit(0)\n      });\n    } else {\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        setStyleAttribute(this.actionObj.clone, {\n          height: formatUnit(this.actionObj.cellHeight),\n          width: formatUnit(this.actionObj.cellWidth - 1),\n          pointerEvents: 'none'\n        });\n      }\n      var top_1 = parseInt(e.top, 10);\n      top_1 = top_1 < 0 ? 0 : top_1;\n      topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\n      var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n      var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n      if (cloneBottom > scrollHeight) {\n        topValue = parseInt(topValue, 10) - (cloneBottom - scrollHeight) + 'px';\n      }\n    }\n    return {\n      left: leftValue,\n      top: topValue\n    };\n  };\n  DragAndDrop.prototype.setDragActionDefaultValues = function () {\n    this.actionObj.action = 'drag';\n    this.actionObj.isAllDay = null;\n    this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n    this.actionObj.interval = this.actionObj.slotInterval;\n    var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n    this.actionObj.cellWidth = workCell.offsetWidth;\n    this.actionObj.cellHeight = workCell.offsetHeight;\n  };\n  DragAndDrop.prototype.dragStart = function (e) {\n    var _this = this;\n    var eventGuid = this.actionObj.element.getAttribute('data-guid');\n    this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    if (!isNullOrUndefined(eventObj)) {\n      this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n    }\n    var dragArgs = {\n      cancel: false,\n      data: eventObj,\n      selectedData: this.getSelectedData(),\n      event: e,\n      excludeSelectors: null,\n      element: this.actionObj.element,\n      interval: this.actionObj.interval,\n      navigation: {\n        enable: false,\n        timeDelay: 2000\n      },\n      scroll: {\n        enable: true,\n        scrollBy: 30,\n        timeDelay: 100\n      }\n    };\n    this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel || !isNullOrUndefined(_this.actionObj.element) && isNullOrUndefined(_this.actionObj.element.parentElement)) {\n        var dragObj = _this.actionObj.element.ej2_instances[0];\n        if (!isNullOrUndefined(dragObj)) {\n          dragObj.intDestroy(e.event);\n        }\n        _this.actionObj.action = '';\n        _this.removeCloneElementClasses();\n        _this.removeCloneElement();\n        return;\n      }\n      _this.actionClass('addClass');\n      _this.parent.uiStateValues.action = true;\n      _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n      _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n      _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n      _this.actionObj.interval = dragEventArgs.interval;\n      _this.actionObj.navigation = dragEventArgs.navigation;\n      _this.actionObj.scroll = dragEventArgs.scroll;\n      _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n      var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n      _this.scrollArgs = {\n        element: viewElement,\n        width: viewElement.scrollWidth,\n        height: viewElement.scrollHeight\n      };\n      _this.widthPerMinute = _this.actionObj.cellWidth / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.heightPerMinute = _this.actionObj.cellHeight / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.widthUptoCursorPoint = 0;\n      _this.heightUptoCursorPoint = 0;\n      _this.cursorPointIndex = -1;\n      _this.isHeaderRows = false;\n      _this.isTimelineDayProcess = false;\n      _this.minDiff = 0;\n      _this.isMorePopupOpened = false;\n      _this.daysVariation = -1;\n      _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n      if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n        if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) && _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n          _this.isMorePopupOpened = true;\n        }\n        _this.actionObj.pageX = e.event.pageX;\n        var rows = _this.parent.activeViewOptions.headerRows;\n        _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' && rows[rows.length - 1].option !== 'Date';\n        _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows || _this.parent.currentView === 'TimelineMonth' || rows.length > 0 && rows[rows.length - 1].option === 'Date';\n        _this.isStepDragging = !_this.isTimelineDayProcess && _this.actionObj.slotInterval !== _this.actionObj.interval;\n        if (_this.isTimelineDayProcess) {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n        } else {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n        }\n      }\n      if (_this.parent.currentView === 'TimelineYear') {\n        _this.yearEvent = new YearEvent(_this.parent);\n      }\n      if (_this.parent.currentView === 'Month') {\n        _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n        _this.updateOriginalElement(_this.actionObj.clone);\n        _this.monthEvent = new MonthEvent(_this.parent);\n      }\n      if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n        _this.verticalEvent = new VerticalEvent(_this.parent);\n        _this.verticalEvent.initializeValues();\n        var splitEvents = _this.splitEvent(_this.actionObj.event);\n        splitEvents.forEach(function (event) {\n          var query = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(event[_this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n          if (_this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query.concat('[data-group-index = \"' + _this.actionObj.groupIndex + '\"]');\n          }\n          var appWrap = _this.parent.element.querySelector(query);\n          if (appWrap) {\n            var appEle = appWrap.querySelector('[data-id=\"' + _this.actionObj.clone.getAttribute('data-id') + '\"]');\n            if (appEle) {\n              addClass([appEle], cls.EVENT_ACTION_CLASS);\n            }\n          }\n        });\n      }\n    });\n  };\n  DragAndDrop.prototype.getSelectedData = function () {\n    if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n      for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n        var element = _a[_i];\n        var eventGuid = element.getAttribute('data-guid');\n        var data = this.parent.eventBase.getEventByGuid(eventGuid);\n        this.multiData.push(extend({}, data, null, true));\n      }\n    }\n    return this.multiData;\n  };\n  DragAndDrop.prototype.drag = function (e) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide(true);\n    }\n    if (!isNullOrUndefined(e.target) && e.target.classList.contains(cls.DISABLE_DATES)) {\n      return;\n    }\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventArgs = this.getPageCoordinates(e);\n    this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n    this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n    this.actionObj.target = e.target;\n    this.widthUptoCursorPoint = this.widthUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute) * this.widthPerMinute : this.widthUptoCursorPoint;\n    this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n    this.heightUptoCursorPoint = this.heightUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute) * this.heightPerMinute : this.heightUptoCursorPoint;\n    this.isAllDayDrag = this.parent.activeViewOptions.timeScale.enable ? this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) : this.actionObj.event[this.parent.eventFields.isAllDay];\n    if (this.isStepDragging && this.minDiff === 0) {\n      this.calculateMinutesDiff(eventObj);\n    }\n    if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n      var date = this.parent.getDateFromElement(this.actionObj.target);\n      if (!isNullOrUndefined(date)) {\n        var currentDate = util.resetTime(date);\n        var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n        this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n      } else {\n        this.daysVariation = 0;\n      }\n    } else {\n      this.daysVariation = 0;\n    }\n    if (this.parent.eventDragArea) {\n      var targetElement = eventArgs.target;\n      this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n      this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n      var currentTarget = closest(targetElement, '.' + cls.ROOT);\n      if (!currentTarget) {\n        this.actionObj.clone.style.height = '';\n        this.actionObj.clone.style.width = '';\n      } else {\n        if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n          this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n        }\n      }\n    }\n    this.updateScrollPosition(e);\n    this.updateNavigatingPosition(e);\n    this.updateDraggingDateTime(e);\n    var dragArgs = {\n      data: eventObj,\n      event: e,\n      element: this.actionObj.element,\n      startTime: this.actionObj.start,\n      endTime: this.actionObj.end,\n      selectedData: this.updatedData\n    };\n    if (this.parent.group.resources.length > 0) {\n      dragArgs.groupIndex = this.actionObj.groupIndex;\n    }\n    this.parent.trigger(events.drag, dragArgs);\n  };\n  DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n    if (this.parent.enableRtl) {\n      this.minDiff = (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute * this.actionObj.interval;\n    } else {\n      this.minDiff = this.widthUptoCursorPoint / this.widthPerMinute * this.actionObj.interval;\n    }\n    var startDate = eventObj[this.parent.eventFields.startTime];\n    var startTime = this.parent.activeView.renderDates[0];\n    var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n    if (startEndHours.startHour.getTime() > startDate.getTime()) {\n      this.minDiff = this.minDiff + (startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE;\n    }\n  };\n  DragAndDrop.prototype.dragStop = function (e) {\n    var _this = this;\n    this.isCursorAhead = false;\n    this.removeCloneElementClasses();\n    this.removeCloneElement();\n    clearInterval(this.actionObj.navigationInterval);\n    this.actionObj.navigationInterval = null;\n    clearInterval(this.actionObj.scrollInterval);\n    this.actionObj.scrollInterval = null;\n    this.actionClass('removeClass');\n    this.parent.uiStateValues.action = false;\n    this.actionObj.action = null;\n    if (this.isAllowDrop(e)) {\n      return;\n    }\n    var target = !e.target.classList.contains('e-work-cells') && this.parent.cellTemplate ? closest(e.target, '.e-work-cells') : e.target;\n    var dragArgs = {\n      cancel: false,\n      data: this.getChangedData(this.updatedData),\n      selectedData: this.updatedData,\n      event: e,\n      element: this.actionObj.element,\n      target: target\n    };\n    this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel) {\n        return;\n      }\n      if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\n        _this.parent.crudModule.crudObj.isCrudAction = true;\n        _this.parent.crudModule.crudObj.sourceEvent = [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n        var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n        _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n      }\n      _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n    });\n    this.updatedData = [];\n    this.multiData = [];\n    this.isMultiSelect = false;\n    this.parent.selectedElements = [];\n  };\n  DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n    var _this = this;\n    if (this.actionObj.navigation.enable) {\n      var currentDate_1 = this.parent.getCurrentTime();\n      if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n        this.actionObj.navigationInterval = window.setInterval(function () {\n          if (currentDate_1) {\n            var crtDate = _this.parent.getCurrentTime();\n            var end = crtDate.getSeconds();\n            var start = currentDate_1.getSeconds() + _this.actionObj.navigation.timeDelay / 1000;\n            start = start >= 60 ? start - 60 : start;\n            if (start === end) {\n              currentDate_1 = _this.parent.getCurrentTime();\n              _this.viewNavigation(e);\n              _this.updateDraggingDateTime(e);\n            }\n          }\n        }, this.actionObj.navigation.timeDelay);\n      }\n    }\n  };\n  DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n    if (!isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      this.morePopupEventDragging(e);\n    } else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n      this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n      this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n      this.timelineEventModule.getSlotDates();\n      this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n      this.calculateTimelineTime(e);\n    } else {\n      if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n        this.calculateVerticalDate(e);\n      } else {\n        this.calculateVerticalTime(e);\n      }\n    }\n  };\n  DragAndDrop.prototype.navigationWrapper = function () {\n    if (!this.parent.activeView.isTimelineView()) {\n      if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n        var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n        this.actionObj.index = this.parent.activeView.renderDates.length < this.actionObj.index ? this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n        var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!targetWrapper) {\n          targetWrapper = createElement('div', {\n            className: cls.APPOINTMENT_WRAPPER_CLASS\n          });\n          outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n        }\n        targetWrapper.appendChild(this.actionObj.clone);\n      } else {\n        var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n        this.parent.element.querySelectorAll(wrapperClass).item(this.actionObj.index).appendChild(this.actionObj.clone);\n        if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n          var elementHeight = this.getAllDayEventHeight();\n          var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n          if (event_2[0].offsetHeight < elementHeight) {\n            for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n              var e = event_1[_i];\n              e.style.height = (elementHeight + 2) / 12 + 'em';\n            }\n          }\n          this.actionObj.clone.style.height = formatUnit(elementHeight);\n        }\n        this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n      }\n    } else {\n      var outWrapper = void 0;\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n      } else {\n        outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n      }\n      if (!isNullOrUndefined(outWrapper)) {\n        var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!tarWrapper_1) {\n          tarWrapper_1 = createElement('div', {\n            className: cls.APPOINTMENT_WRAPPER_CLASS\n          });\n          outWrapper.appendChild(tarWrapper_1);\n        }\n        this.actionObj.cloneElement.forEach(function (ele) {\n          tarWrapper_1.appendChild(ele);\n        });\n      }\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  DragAndDrop.prototype.viewNavigation = function (e) {\n    var navigationType;\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    if (dragArea && (!this.scrollEdges.top && !this.scrollEdges.bottom || closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n      if (dragArea.scrollLeft === 0 && Math.round(this.actionObj.X) <= Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'next' : 'previous';\n      } else if (Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth && Math.round(this.actionObj.X) >= Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'previous' : 'next';\n      }\n      if (navigationType) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n      }\n    }\n  };\n  DragAndDrop.prototype.morePopupEventDragging = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'td'))) {\n      return;\n    }\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(e.target, 'td');\n    if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n      return;\n    }\n    var dragStart = this.parent.getDateFromElement(td);\n    var dragEnd = new Date(dragStart.getTime());\n    dragEnd.setMilliseconds(eventDuration);\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n    this.actionObj.start = new Date(dragStart.getTime());\n    this.actionObj.end = new Date(dragEnd.getTime());\n    this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n    this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n    this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n    var eventContainer = td;\n    var eventWrapper;\n    if (this.parent.activeView.isTimelineView()) {\n      var rowIndex = closest(td, 'tr').rowIndex;\n      eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n    }\n    eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n    this.appendCloneElement(eventWrapper);\n  };\n  DragAndDrop.prototype.calculateVerticalTime = function (e) {\n    var _this = this;\n    if (isNullOrUndefined(this.actionObj.target) || this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr')) || !closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) && !closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      return;\n    }\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      this.swapDragging(e);\n    }\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventStart = eventObj[this.parent.eventFields.startTime];\n    var eventEnd = eventObj[this.parent.eventFields.endTime];\n    var eventDuration = eventEnd.getTime() - eventStart.getTime();\n    var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n    offsetTop = offsetTop < 0 ? 0 : offsetTop;\n    if (this.scrollEdges.top || this.scrollEdges.bottom) {\n      offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint + this.actionObj.cellHeight + window.pageYOffset : dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset + (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n      offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n      this.actionObj.clone.style.top = formatUnit(offsetTop);\n    }\n    var rowIndex = this.parent.activeViewOptions.timeScale.enable ? offsetTop / this.actionObj.cellHeight : 0;\n    var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n    var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n    var tr;\n    if (this.isAllDayDrag) {\n      tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n    } else {\n      var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n      tr = trCollections[rowIndex];\n    }\n    var index;\n    if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) || closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      index = closest(this.actionObj.target, 'td').cellIndex;\n    }\n    var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n    this.actionObj.index = colIndex;\n    if (isNullOrUndefined(tr)) {\n      return;\n    }\n    var td = tr.children[colIndex];\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n    var dragStart;\n    var dragEnd;\n    if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setMinutes(dragStart.getMinutes() + diffInMinutes / heightPerMinute);\n      dragEnd = new Date(dragStart.getTime());\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n      } else {\n        dragEnd.setMilliseconds(eventDuration);\n      }\n    } else {\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setDate(dragStart.getDate() - this.daysVariation);\n      dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n      dragEnd = new Date(dragStart.getTime());\n      dragEnd.setMilliseconds(eventDuration);\n      if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n      }\n      this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n    }\n    this.actionObj.start = new Date(+dragStart);\n    this.actionObj.end = new Date(+dragEnd);\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    var dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n    for (var _i = 0, dynamicWrappers_1 = dynamicWrappers; _i < dynamicWrappers_1.length; _i++) {\n      var wrapper = dynamicWrappers_1[_i];\n      remove(wrapper);\n    }\n    if (this.multiData.length > 0) {\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n        var targetCellTime_1 = parseInt(closest(this.actionObj.target, 'td').getAttribute('data-date'), 10);\n        this.multiData.forEach(function (data) {\n          _this.swagData.push(extend({}, data, null, true));\n          if (data[_this.parent.eventFields.isAllDay]) {\n            data[_this.parent.eventFields.startTime] = new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n            var startTime = new Date(data[_this.parent.eventFields.startTime]);\n            var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n            data[_this.parent.eventFields.endTime] = endTime;\n            data[_this.parent.eventFields.isAllDay] = false;\n          }\n        });\n        this.startTime = targetCellTime_1;\n      }\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n        this.multiData = this.swagData;\n        this.swagData = [];\n        var eventObj_1 = extend({}, this.actionObj.event, null, true);\n        this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n      }\n      var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n      for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\n        this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\n        var dayIndex = this.getDayIndex(this.updatedData[index_1]);\n        if (dayIndex >= 0) {\n          var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\n          this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\n          this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\n        } else {\n          if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\n            remove(this.actionObj.cloneElement[index_1]);\n          }\n        }\n      }\n    } else {\n      this.updateEventHeight(event);\n    }\n    this.updateTimePosition(this.actionObj.start, this.updatedData);\n  };\n  DragAndDrop.prototype.splitEvent = function (event) {\n    var eventFields = this.parent.eventFields;\n    var eventData = [];\n    var startTime = event[eventFields.startTime];\n    var endTime = event[eventFields.endTime];\n    if (util.resetTime(new Date(startTime.getTime())) < util.resetTime(new Date(endTime.getTime()))) {\n      var startReferenceDate = util.resetTime(new Date(startTime.getTime()));\n      var endReferenceDate = new Date(startReferenceDate.getTime());\n      for (var i = 0; startReferenceDate < new Date(endTime.getTime()); i++) {\n        endReferenceDate = new Date(endReferenceDate.setDate(startReferenceDate.getDate() + 1));\n        var eventObj = extend({}, event, null, true);\n        eventObj[eventFields.startTime] = new Date(startReferenceDate);\n        eventObj[eventFields.endTime] = new Date(endReferenceDate);\n        startReferenceDate = new Date(startReferenceDate.setDate(startReferenceDate.getDate() + 1));\n        eventData.push(eventObj);\n      }\n      var index = eventData.length - 1;\n      eventData[0][eventFields.startTime] = startTime;\n      eventData[index][eventFields.endTime] = endTime;\n    } else {\n      eventData.push(event);\n    }\n    return eventData;\n  };\n  DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n    if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable && (this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay] || !this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay])) {\n      eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n    }\n    var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    if (eventObj[this.parent.eventFields.isAllDay]) {\n      var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n      var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n      var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n      eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n      eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n    } else {\n      eventObj[this.parent.eventFields.startTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n      eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n    }\n    return eventObj;\n  };\n  DragAndDrop.prototype.getDayIndex = function (event) {\n    var eventObj = extend({}, event, null, true);\n    var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n    var query = '';\n    var wrapper = cls.DAY_WRAPPER_CLASS;\n    if (this.parent.activeViewOptions.timeScale.enable && eventObj[this.parent.eventFields.isAllDay]) {\n      wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n    } else {\n      wrapper = cls.WORK_CELLS_CLASS;\n    }\n    query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n    }\n    this.targetTd = this.parent.element.querySelector(query);\n    if (isNullOrUndefined(this.targetTd)) {\n      return -1;\n    }\n    return this.targetTd.cellIndex;\n  };\n  DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n    this.verticalEvent.initializeValues();\n    var datesCount = 0;\n    if (!this.parent.uiStateValues.isGroupAdaptive) {\n      for (var i = 0; i < this.actionObj.groupIndex; i++) {\n        datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n      }\n    }\n    var indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\n    var target = this.parent.activeViewOptions.group.byDate && !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target)) ? true : false;\n    if (target || !this.parent.activeViewOptions.group.byDate) {\n      var dynamicIndex = -1;\n      var dayIndex = !this.parent.activeViewOptions.group.byDate ? isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount : this.parent.getIndexOfDate(this.verticalEvent.dateRender[indexGroup], util.resetTime(\n      // eslint-disable-next-line max-len\n      this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n      var splitEvents = this.splitEvent(event);\n      var events_1 = this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 || this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' ? [event] : splitEvents;\n      for (var i = 0; i < events_1.length; i++) {\n        if (i > 0) {\n          var filterQuery = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(events_1[i][this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n          if (this.parent.activeViewOptions.group.resources.length > 0) {\n            filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n          }\n          var appWrap = this.parent.element.querySelector(filterQuery);\n          if (appWrap) {\n            dayIndex = dayIndex + 1;\n            dynamicIndex = appWrap.cellIndex;\n          } else {\n            dayIndex = -1;\n          }\n        }\n        if (dayIndex >= 0) {\n          var record = this.verticalEvent.isSpannedEvent(events_1[i], dayIndex, indexGroup);\n          var eStart = record[this.verticalEvent.fields.startTime];\n          var eEnd = record[this.verticalEvent.fields.endTime];\n          var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) : this.actionObj.element.offsetHeight;\n          var topValue = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getTopValue(eStart, dayIndex, indexGroup) : this.actionObj.element.offsetTop;\n          if (isNullOrUndefined(index)) {\n            if (i === 0) {\n              this.actionObj.clone.style.top = formatUnit(topValue);\n              this.actionObj.clone.style.height = formatUnit(appHeight);\n            } else {\n              this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n            }\n          } else {\n            var appWidth = this.actionObj.cellWidth;\n            if (event[this.parent.eventFields.isAllDay]) {\n              topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n              appHeight = this.getAllDayEventHeight();\n              var timeDiff = event[this.parent.eventFields.endTime].getTime() - event[this.parent.eventFields.startTime].getTime();\n              var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n              if (allDayDifference >= 0) {\n                appWidth = allDayDifference * this.actionObj.cellWidth;\n              }\n            }\n            if (this.actionObj.cloneElement[index]) {\n              if (i === 0) {\n                this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n                this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n                this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n                this.actionObj.cloneElement[index].style.left = formatUnit(0);\n              } else {\n                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n  DragAndDrop.prototype.renderSpannedEvents = function (record, index, top, height) {\n    var startTime = record[this.parent.eventFields.startTime].getTime();\n    var endTime = record[this.parent.eventFields.endTime].getTime();\n    if (startTime !== endTime) {\n      var appointmentElement = this.verticalEvent.createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\n      addClass([appointmentElement], [cls.CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\n      setStyleAttribute(appointmentElement, {\n        'width': '100%',\n        'height': height + 'px',\n        'top': top + 'px',\n        'border': '0px'\n      });\n      var appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n      appointmentWrap[index].appendChild(appointmentElement);\n    }\n  };\n  DragAndDrop.prototype.getRenderedDates = function () {\n    var _this = this;\n    var _a, _b;\n    var renderDates = this.parent.activeView.renderDates;\n    (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) {\n      return +date;\n    }));\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.eventBase.slots = [];\n      var resources = this.parent.resourceBase.lastResourceLevel.filter(function (res) {\n        return res.groupIndex === _this.actionObj.groupIndex;\n      });\n      renderDates = resources[0].renderDates;\n      (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) {\n        return +date;\n      }));\n    }\n    return renderDates;\n  };\n  DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n    this.parent.eventBase.slots = [];\n    var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n    var renderDates = this.getRenderedDates();\n    var events = this.parent.eventBase.splitEvent(event, renderDates);\n    var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n    }\n    var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n    if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n      var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n      this.appendCloneElement(this.getEventWrapper(cellIndex));\n      // eslint-disable-next-line max-len\n      this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  DragAndDrop.prototype.swapDragging = function (e) {\n    var colIndex = closest(this.actionObj.target, 'td').cellIndex;\n    if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) && !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n      addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = true;\n      var eventHeight = this.getAllDayEventHeight();\n      var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n      if (allDayElement[0].offsetHeight < eventHeight) {\n        for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n          var element = allDayElement_1[_i];\n          element.style.height = (eventHeight + 2) / 12 + 'em';\n        }\n      }\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(this.actionObj.cellWidth),\n        height: formatUnit(eventHeight),\n        top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n      });\n    }\n    if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) && !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n      removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = false;\n      // eslint-disable-next-line max-len\n      var height = this.actionObj.element.offsetHeight === 0 ? this.actionObj.height : this.actionObj.element.offsetHeight;\n      setStyleAttribute(this.actionObj.clone, {\n        left: formatUnit(0),\n        height: formatUnit(height),\n        width: formatUnit(this.actionObj.cellWidth)\n      });\n    }\n  };\n  DragAndDrop.prototype.calculateVerticalDate = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'tr')) || e.target && e.target.tagName === 'DIV') {\n      return;\n    }\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    if (isNullOrUndefined(this.parent.eventDragArea)) {\n      this.removeCloneElement();\n    }\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(this.actionObj.target, 'td');\n    if (!isNullOrUndefined(td)) {\n      var tr = td.parentElement;\n      this.actionObj.index = tr.rowIndex * tr.children.length + td.cellIndex;\n      var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n      td = workCells[this.actionObj.index];\n      var currentDate = this.parent.getDateFromElement(td);\n      if (!isNullOrUndefined(currentDate)) {\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n        var dragStart = new Date(timeString.getTime());\n        var dragEnd = new Date(dragStart.getTime());\n        var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() - util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime])).getTime();\n        dragStart = new Date(dragStart.getTime() + startTimeDiff);\n        dragEnd = new Date(dragStart.getTime() + eventDuration);\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n      }\n    }\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n    for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n      var wrapper = eventWrappers_1[_i];\n      remove(wrapper);\n    }\n    if (this.multiData && this.multiData.length > 0) {\n      var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n      var startTimeDiff = startTime.getTime() - this.startTime;\n      if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n        startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n        startTimeDiff -= new Date(this.startTime).getMonth();\n        startTimeDiff += startTime.getMonth();\n      }\n      for (var index = 0; index < this.multiData.length; index++) {\n        this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n        if (this.parent.currentView === 'TimelineYear') {\n          this.dynamicYearlyEventsRendering(this.updatedData[index]);\n        } else {\n          this.dynamicEventsRendering(this.updatedData[index]);\n        }\n      }\n    } else {\n      if (this.parent.currentView === 'TimelineYear') {\n        this.dynamicYearlyEventsRendering(event);\n      } else {\n        this.dynamicEventsRendering(event);\n      }\n    }\n  };\n  DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n    if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n    } else {\n      var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n    }\n    eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n    return eventObj;\n  };\n  DragAndDrop.prototype.calculateTimelineTime = function (e) {\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth : parseInt(this.actionObj.clone.style.left, 10);\n    offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n    var rightOffset;\n    if (this.parent.enableRtl) {\n      rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n      this.actionObj.clone.style.right = formatUnit(rightOffset);\n    }\n    offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n    var colIndex = this.getColumnIndex(offsetLeft);\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n    var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl && this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n    var leftVal = this.parent.eventDragArea ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n    if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n      this.isCursorAhead = true;\n    }\n    var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n    if (this.parent.enableRtl) {\n      cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) / this.actionObj.cellWidth)) - 1;\n    }\n    if (this.cursorPointIndex < 0) {\n      this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n    }\n    var tr = this.parent.getContentTable().querySelector('tr');\n    var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n    index = index < 0 ? 0 : index;\n    var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) : this.parent.getDateFromElement(tr.children[index]);\n    if (this.isStepDragging) {\n      var widthDiff = this.getWidthDiff(tr, index);\n      if (widthDiff !== 0) {\n        var timeDiff = Math.round(widthDiff / this.widthPerMinute);\n        eventStart.setMinutes(eventStart.getMinutes() + timeDiff * this.actionObj.interval);\n        if (this.isCursorAhead || cursorDrag) {\n          eventStart.setMilliseconds(-eventDuration);\n        } else {\n          eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n        }\n      } else {\n        eventStart = this.actionObj.start;\n      }\n    } else {\n      if (this.isCursorAhead || cursorDrag) {\n        eventStart.setMinutes(eventStart.getMinutes() + (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n        eventStart.setMilliseconds(-eventDuration);\n      } else {\n        eventStart.setMinutes(eventStart.getMinutes() - this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n      }\n    }\n    eventStart = this.calculateIntervalTime(eventStart);\n    if (this.isTimelineDayProcess) {\n      var eventSrt = eventObj[this.parent.eventFields.startTime];\n      eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n    }\n    if (this.parent.eventDragArea) {\n      var targetDate = this.parent.getDateFromElement(e.target);\n      if (!isNullOrUndefined(targetDate)) {\n        if (!this.parent.activeViewOptions.timeScale.enable || this.parent.currentView === 'TimelineMonth') {\n          var eventSrt = eventObj[this.parent.eventFields.startTime];\n          eventStart = new Date(targetDate.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds()));\n        } else {\n          eventStart = targetDate;\n        }\n      }\n    }\n    var eventEnd = new Date(eventStart.getTime());\n    eventEnd.setMilliseconds(eventDuration);\n    var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n    if (this.multiData.length > 0) {\n      var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n      for (var i = 0; i < this.multiData.length; i++) {\n        this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n      }\n      eventsData = this.updatedData;\n    }\n    for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n      var events_2 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n      var eventData = events_2[0].data;\n      var startTime = this.timelineEventModule.getStartTime(events_2[0], eventData);\n      var endTime = this.timelineEventModule.getEndTime(events_2[0], eventData);\n      // eslint-disable-next-line max-len\n      var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count);\n      // eslint-disable-next-line max-len\n      var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n      day = day < 0 ? 0 : day;\n      var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n      var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n      if (this.parent.enableRtl) {\n        cloneElement.style.right = formatUnit(left);\n      } else {\n        cloneElement.style.left = formatUnit(left);\n      }\n      if (!this.isMorePopupOpened) {\n        cloneElement.style.width = formatUnit(width);\n      }\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        this.calculateResourceGroupingPosition(e, cloneElement);\n      }\n      this.actionObj.start = new Date(eventStart.getTime());\n      this.actionObj.end = new Date(eventEnd.getTime());\n      this.updateTimePosition(this.actionObj.start, this.updatedData);\n    }\n  };\n  DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n    if (this.scrollEdges.left || this.scrollEdges.right) {\n      var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n      if (this.parent.enableRtl) {\n        rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n        if (this.scrollEdges.right) {\n          rightOffset = rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth - (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        } else {\n          rightOffset = rightOffset + this.widthUptoCursorPoint;\n          if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n            this.actionObj.clone.style.width = formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n            rightOffset = viewEle.scrollLeft - viewEle.scrollWidth;\n          }\n        }\n        this.actionObj.clone.style.left = formatUnit(rightOffset);\n      } else {\n        if (this.scrollEdges.left) {\n          offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n          if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n            viewEle.scrollLeft = viewEle.scrollLeft - 1;\n          } else if (this.actionObj.clone.offsetLeft === 0) {\n            offsetLeft = viewEle.scrollLeft;\n          }\n        } else {\n          offsetLeft = viewEle.scrollLeft + viewEle.offsetWidth - this.actionObj.clone.offsetWidth + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        }\n        offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n        this.actionObj.clone.style.left = formatUnit(offsetLeft);\n      }\n    }\n    return offsetLeft;\n  };\n  DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n    var pages = this.scrollArgs.element.getBoundingClientRect();\n    if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n      var targetLeft = tr.children[index].offsetLeft;\n      var pageX = this.actionObj.pageX - pages.left;\n      if (this.parent.enableRtl) {\n        return targetLeft + this.actionObj.cellWidth - (this.scrollArgs.element.scrollLeft + pageX);\n      } else {\n        return this.scrollArgs.element.scrollLeft + pageX - targetLeft;\n      }\n    }\n    return 0;\n  };\n  DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n    var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n    if (this.isHeaderRows) {\n      return index;\n    }\n    return this.getIndex(index);\n  };\n  DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n    var index = colIndex + cloneIndex;\n    if (this.isHeaderRows) {\n      var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n      return index > dateLength - 1 ? dateLength - 1 : index;\n    }\n    return index > tr.children.length - 1 ? tr.children.length - 1 : index;\n  };\n  DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n    var td = closest(e.target, '.e-work-cells');\n    if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n      var targetDate = this.parent.getDateFromElement(td);\n      if (this.isHeaderRows) {\n        var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n        targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n      }\n      var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n      if (this.isTimelineDayProcess) {\n        this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / util.MS_PER_DAY));\n      } else {\n        var widthDiff = Math.floor(timeDiff / util.MS_PER_MINUTE / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n        this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n        this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n      }\n    } else {\n      this.cursorPointIndex = 0;\n    }\n  };\n  DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n    var translateY = util.getTranslateY(dragArea.querySelector('table'));\n    translateY = isNullOrUndefined(translateY) ? 0 : translateY;\n    var rowHeight = this.parent.rowAutoHeight ? ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n    var rowIndex = Math.floor(Math.floor(this.actionObj.Y + (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset)) - dragArea.getBoundingClientRect().top) / rowHeight);\n    rowIndex = rowIndex < 0 ? 0 : rowIndex > trCollection.length - 1 ? trCollection.length - 1 : rowIndex;\n    this.actionObj.index = rowIndex;\n    var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n    var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n    this.appendCloneElement(eventWrapper, cloneElement);\n    var td = closest(this.actionObj.target, 'td');\n    this.actionObj.groupIndex = td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)) ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n    var top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\n    if (this.parent.rowAutoHeight) {\n      var cursorElement = this.getCursorElement(e);\n      if (cursorElement) {\n        top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop : cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ? cursorElement.offsetParent.offsetTop : top;\n      }\n    }\n    cloneElement.style.top = formatUnit(top);\n  };\n  DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n    if (cloneElement === void 0) {\n      cloneElement = null;\n    }\n    cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n    if (this.parent.eventDragArea && dragElement) {\n      dragElement.appendChild(cloneElement);\n    } else {\n      element.appendChild(cloneElement);\n    }\n  };\n  DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n    var eventWrapper;\n    if (isNullOrUndefined(isAllDayDrag)) {\n      isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n    }\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n      eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n    } else {\n      var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n      eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n      if (!eventWrapper) {\n        eventWrapper = createElement('div', {\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        targetWrapper.appendChild(eventWrapper);\n      }\n    }\n    return eventWrapper;\n  };\n  DragAndDrop.prototype.getAllDayEventHeight = function () {\n    var eventWrapper = createElement('div', {\n      className: cls.APPOINTMENT_CLASS\n    });\n    this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n    var eventHeight = eventWrapper.offsetHeight;\n    remove(eventWrapper);\n    return eventHeight;\n  };\n  DragAndDrop.prototype.isAllowDrop = function (e) {\n    if (!this.actionObj.excludeSelectors) {\n      return false;\n    }\n    var dropSelectors = this.actionObj.excludeSelectors.split(',');\n    var isAllowDrop = false;\n    for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n      var selector = dropSelectors_1[_i];\n      if (e.target.classList.contains(selector)) {\n        isAllowDrop = true;\n        break;\n      }\n    }\n    return isAllowDrop;\n  };\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name\n   */\n  DragAndDrop.prototype.getModuleName = function () {\n    return 'dragAndDrop';\n  };\n  return DragAndDrop;\n}(ActionBase);\nexport { DragAndDrop };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","createElement","closest","Draggable","extend","formatUnit","isNullOrUndefined","addClass","remove","removeClass","setStyleAttribute","ActionBase","MonthEvent","TimelineEvent","YearEvent","VerticalEvent","cls","events","util","MINUTES_PER_DAY","DragAndDrop","_super","_this","apply","arguments","widthUptoCursorPoint","heightUptoCursorPoint","cursorPointIndex","isHeaderRows","isTimelineDayProcess","widthPerMinute","heightPerMinute","minDiff","isStepDragging","isMorePopupOpened","isAllDayDrag","isMultiSelect","multiData","updatedData","swagData","startTime","isAllDayTarget","targetTd","isCursorAhead","wireDragEvent","element","abort","EVENT_RESIZE_CLASS","clone","isDragScroll","enableTapHold","parent","isAdaptive","enableTailMode","eventDragArea","cursorAt","left","top","dragArea","dragStart","bind","drag","dragStop","enableAutoScroll","helper","dragHelper","queryPositionInfo","dragPosition","setDragArea","dragElement","document","querySelector","CONTENT_TABLE_CLASS","e","setDragActionDefaultValues","actionObj","action","elements","allowMultiDrag","selectedElements","length","indexOf","forEach","ele","cloneElement","createCloneElement","getAttribute","currentView","activeViewOptions","timeScale","enable","activeView","isTimelineView","classList","contains","ALLDAY_APPOINTMENT_CLASS","cursor","right","width","style","offsetTop","push","originalElement","cellHeight","slotInterval","interval","leftValue","cloneRight","Math","ceil","getBoundingClientRect","CONTENT_WRAP_CLASS","contentWrapRight","enableRtl","pageX","offsetLeft","topValue","offsetParent","MORE_EVENT_POPUP_CLASS","ALLDAY_ROW_CLASS","offsetWidth","cellWidth","height","pointerEvents","top_1","parseInt","scrollHeight","cloneBottom","offsetHeight","isAllDay","slotCount","workCell","WORK_CELLS_CLASS","eventGuid","event","eventBase","getEventByGuid","eventObj","eventFields","getTime","dragArgs","cancel","data","selectedData","getSelectedData","excludeSelectors","navigation","timeDelay","scroll","scrollBy","trigger","dragEventArgs","parentElement","dragObj","ej2_instances","intDestroy","removeCloneElementClasses","removeCloneElement","actionClass","uiStateValues","start","end","endTime","groupIndex","viewElement","scrollArgs","scrollWidth","daysVariation","rows","headerRows","option","timelineEventModule","yearEvent","resetTime","Date","updateOriginalElement","monthEvent","verticalEvent","initializeValues","splitEvents","splitEvent","query","group","resources","concat","appWrap","appEle","EVENT_ACTION_CLASS","_i","_a","quickPopup","quickPopupHide","target","DISABLE_DATES","eventArgs","getPageCoordinates","Y","pageY","X","abs","calculateMinutesDiff","date","getDateFromElement","currentDate","startDate","MS_PER_DAY","targetElement","currentTarget","ROOT","updateScrollPosition","updateNavigatingPosition","updateDraggingDateTime","renderDates","startEndHours","getStartEndHours","getStartHour","getEndHour","startHour","MS_PER_MINUTE","clearInterval","navigationInterval","scrollInterval","isAllowDrop","cellTemplate","getChangedData","allowGroupEdit","rowAutoHeight","virtualScrollModule","byGroupID","crudModule","crudObj","isCrudAction","sourceEvent","resourceBase","lastResourceLevel","currentGroupIndex","targetEvent","saveChangedData","currentDate_1","getCurrentTime","window","setInterval","crtDate","getSeconds","viewNavigation","morePopupEventDragging","dateRender","getSlotDates","calculateTimelineTime","calculateVerticalDate","calculateVerticalTime","navigationWrapper","outerWrapperCls","slice","call","querySelectorAll","index","targetWrapper","APPOINTMENT_WRAPPER_CLASS","className","appendChild","wrapperClass","ALLDAY_APPOINTMENT_WRAPPER_CLASS","item","elementHeight","getAllDayEventHeight","event_2","ALLDAY_CELLS_CLASS","event_1","outWrapper","APPOINTMENT_CONTAINER_CLASS","tarWrapper_1","navigationType","scrollEdges","bottom","scrollLeft","round","pageXOffset","clientWidth","changeDate","getNextPreviousDate","eventDuration","td","dragEnd","setMilliseconds","eventContainer","eventWrapper","rowIndex","appendCloneElement","swapDragging","eventStart","eventEnd","floor","scrollTop","pageYOffset","diffInMinutes","tr","trCollections","getContentTable","cellIndex","colIndex","children","isGroupAdaptive","getEventWrapper","setMinutes","getMinutes","setDate","getDate","setHours","getHours","addDays","updateAllDayEvents","byDate","undefined","getUpdatedEvent","dynamicWrappers","dynamicWrappers_1","wrapper","targetCellTime_1","eventObj_1","startTimeDiff","index_1","updateMultipleData","dayIndex","getDayIndex","updateEventHeight","parentNode","updateTimePosition","eventData","startReferenceDate","endReferenceDate","i","timeDifference","endTimeDiff","differInDays","day","DAY_WRAPPER_CLASS","datesCount","indexGroup","dynamicIndex","getIndexOfDate","events_1","isAllDayAppointment","eventSettings","spannedEventPlacement","filterQuery","record","isSpannedEvent","eStart","fields","eEnd","appHeight","getHeight","getTopValue","renderSpannedEvents","appWidth","timeDiff","allDayDifference","appointmentElement","createAppointmentElement","isSpanned","CLONE_ELEMENT_CLASS","appointmentWrap","getRenderedDates","_b","slots","map","filter","res","endDate","cell","count","DATE_HEADER_WRAP_CLASS","eventHeight","allDayElement","allDayElement_1","tagName","workCells","timeString","eventWrappers","eventWrappers_1","getFullYear","getMonth","updateMultipleVerticalDate","dynamicYearlyEventsRendering","dynamicEventsRendering","setMonth","rightOffset","getOffsetValue","getColumnIndex","cursorDrag","leftVal","cloneIndex","cursorIndex","getCursorCurrentIndex","widthDiff","getWidthDiff","calculateIntervalTime","eventSrt","targetDate","eventsData","dataIndex","events_2","getStartTime","getEndTime","getEventWidth","getPosition","calculateResourceGroupingPosition","viewEle","pages","targetLeft","getIndex","dateLength","currentIndex","trCollection","translateY","getTranslateY","rowHeight","scrollY","isNaN","cursorElement","getCursorElement","APPOINTMENT_CLASS","dropSelectors","split","dropSelectors_1","selector","getModuleName"],"sources":["C:/Users/DELL/Downloads/GTSInterviewSchedulerComponent-main/GTSInterviewSchedulerComponent-main/node_modules/@syncfusion/ej2-schedule/src/schedule/actions/drag.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\nvar DragAndDrop = /** @class */ (function (_super) {\n    __extends(DragAndDrop, _super);\n    function DragAndDrop() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.widthUptoCursorPoint = 0;\n        _this.heightUptoCursorPoint = 0;\n        _this.cursorPointIndex = 0;\n        _this.isHeaderRows = false;\n        _this.isTimelineDayProcess = false;\n        _this.widthPerMinute = 0;\n        _this.heightPerMinute = 0;\n        _this.minDiff = 0;\n        _this.isStepDragging = false;\n        _this.isMorePopupOpened = false;\n        _this.isAllDayDrag = false;\n        _this.isMultiSelect = false;\n        _this.multiData = [];\n        _this.updatedData = [];\n        _this.swagData = [];\n        _this.startTime = 0;\n        _this.isAllDayTarget = false;\n        _this.targetTd = null;\n        _this.isCursorAhead = false;\n        return _this;\n    }\n    DragAndDrop.prototype.wireDragEvent = function (element) {\n        new Draggable(element, {\n            abort: '.' + cls.EVENT_RESIZE_CLASS,\n            clone: true,\n            isDragScroll: true,\n            enableTapHold: this.parent.isAdaptive,\n            enableTailMode: (this.parent.eventDragArea) ? true : false,\n            cursorAt: (this.parent.eventDragArea) ? { left: -20, top: -20 } : { left: 0, top: 0 },\n            dragArea: this.dragArea,\n            dragStart: this.dragStart.bind(this),\n            drag: this.drag.bind(this),\n            dragStop: this.dragStop.bind(this),\n            enableAutoScroll: false,\n            helper: this.dragHelper.bind(this),\n            queryPositionInfo: this.dragPosition.bind(this)\n        });\n    };\n    DragAndDrop.prototype.setDragArea = function () {\n        var dragElement = document.querySelector(this.parent.eventDragArea);\n        this.dragArea = this.parent.eventDragArea && dragElement ? dragElement :\n            this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n    };\n    DragAndDrop.prototype.dragHelper = function (e) {\n        var _this = this;\n        this.setDragActionDefaultValues();\n        this.actionObj.element = e.element;\n        this.actionObj.action = 'drag';\n        var elements = [];\n        if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 ||\n            (this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1)) {\n            elements = [e.element];\n        }\n        else {\n            elements = this.parent.selectedElements;\n            this.isMultiSelect = true;\n        }\n        elements.forEach(function (ele) {\n            var cloneElement = _this.createCloneElement(ele);\n            if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n                _this.actionObj.clone = cloneElement;\n                if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' &&\n                    _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() &&\n                    !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                    setStyleAttribute(_this.actionObj.clone, { cursor: 'move', left: '0%', right: '0%', width: '100%' });\n                }\n                _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n            }\n            _this.actionObj.cloneElement.push(cloneElement);\n            _this.actionObj.originalElement.push(ele);\n        });\n        return this.actionObj.clone;\n    };\n    DragAndDrop.prototype.dragPosition = function (e) {\n        if (this.parent.eventDragArea) {\n            return { left: e.left, top: e.top };\n        }\n        var cellHeight = (this.actionObj.cellHeight / this.actionObj.slotInterval) * this.actionObj.interval;\n        var leftValue = formatUnit(0);\n        if (this.parent.currentView === 'Month') {\n            leftValue = e.left;\n        }\n        var cloneRight;\n        if (this.isStepDragging) {\n            cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n        }\n        else {\n            cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n        }\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\n        if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl &&\n            this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n            this.isCursorAhead = true;\n        }\n        if (this.parent.activeView.isTimelineView()) {\n            leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n        }\n        var topValue;\n        if ((this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable ||\n            (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n                this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)))) {\n            topValue = formatUnit(this.actionObj.clone.offsetTop);\n        }\n        else if (this.parent.currentView === 'Month') {\n            topValue = formatUnit(0);\n        }\n        else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n            topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n                right: this.parent.enableRtl && formatUnit(0)\n            });\n        }\n        else {\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                setStyleAttribute(this.actionObj.clone, {\n                    height: formatUnit(this.actionObj.cellHeight),\n                    width: formatUnit(this.actionObj.cellWidth - 1),\n                    pointerEvents: 'none'\n                });\n            }\n            var top_1 = parseInt(e.top, 10);\n            top_1 = top_1 < 0 ? 0 : top_1;\n            topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\n            var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n            var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n            if (cloneBottom > scrollHeight) {\n                topValue = (parseInt(topValue, 10) - (cloneBottom - scrollHeight)) + 'px';\n            }\n        }\n        return { left: leftValue, top: topValue };\n    };\n    DragAndDrop.prototype.setDragActionDefaultValues = function () {\n        this.actionObj.action = 'drag';\n        this.actionObj.isAllDay = null;\n        this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n        this.actionObj.interval = this.actionObj.slotInterval;\n        var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n        this.actionObj.cellWidth = workCell.offsetWidth;\n        this.actionObj.cellHeight = workCell.offsetHeight;\n    };\n    DragAndDrop.prototype.dragStart = function (e) {\n        var _this = this;\n        var eventGuid = this.actionObj.element.getAttribute('data-guid');\n        this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        if (!isNullOrUndefined(eventObj)) {\n            this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n        }\n        var dragArgs = {\n            cancel: false,\n            data: eventObj,\n            selectedData: this.getSelectedData(),\n            event: e,\n            excludeSelectors: null,\n            element: this.actionObj.element,\n            interval: this.actionObj.interval,\n            navigation: { enable: false, timeDelay: 2000 },\n            scroll: { enable: true, scrollBy: 30, timeDelay: 100 }\n        };\n        this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel || (!isNullOrUndefined(_this.actionObj.element) &&\n                isNullOrUndefined(_this.actionObj.element.parentElement))) {\n                var dragObj = _this.actionObj.element.ej2_instances[0];\n                if (!isNullOrUndefined(dragObj)) {\n                    dragObj.intDestroy(e.event);\n                }\n                _this.actionObj.action = '';\n                _this.removeCloneElementClasses();\n                _this.removeCloneElement();\n                return;\n            }\n            _this.actionClass('addClass');\n            _this.parent.uiStateValues.action = true;\n            _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n            _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n            _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n            _this.actionObj.interval = dragEventArgs.interval;\n            _this.actionObj.navigation = dragEventArgs.navigation;\n            _this.actionObj.scroll = dragEventArgs.scroll;\n            _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n            var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            _this.scrollArgs = { element: viewElement, width: viewElement.scrollWidth, height: viewElement.scrollHeight };\n            _this.widthPerMinute = (_this.actionObj.cellWidth / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.heightPerMinute = (_this.actionObj.cellHeight / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.widthUptoCursorPoint = 0;\n            _this.heightUptoCursorPoint = 0;\n            _this.cursorPointIndex = -1;\n            _this.isHeaderRows = false;\n            _this.isTimelineDayProcess = false;\n            _this.minDiff = 0;\n            _this.isMorePopupOpened = false;\n            _this.daysVariation = -1;\n            _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n            if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n                if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) &&\n                    _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n                    _this.isMorePopupOpened = true;\n                }\n                _this.actionObj.pageX = e.event.pageX;\n                var rows = _this.parent.activeViewOptions.headerRows;\n                _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' &&\n                    rows[rows.length - 1].option !== 'Date';\n                _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows ||\n                    _this.parent.currentView === 'TimelineMonth' || (rows.length > 0 && rows[rows.length - 1].option === 'Date');\n                _this.isStepDragging = !_this.isTimelineDayProcess && (_this.actionObj.slotInterval !== _this.actionObj.interval);\n                if (_this.isTimelineDayProcess) {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n                }\n                else {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n                }\n            }\n            if (_this.parent.currentView === 'TimelineYear') {\n                _this.yearEvent = new YearEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Month') {\n                _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n                _this.updateOriginalElement(_this.actionObj.clone);\n                _this.monthEvent = new MonthEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n                _this.verticalEvent = new VerticalEvent(_this.parent);\n                _this.verticalEvent.initializeValues();\n                var splitEvents = _this.splitEvent(_this.actionObj.event);\n                splitEvents.forEach(function (event) {\n                    var query = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(event[_this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n                    if (_this.parent.activeViewOptions.group.resources.length > 0) {\n                        query = query.concat('[data-group-index = \"' + _this.actionObj.groupIndex + '\"]');\n                    }\n                    var appWrap = _this.parent.element.querySelector(query);\n                    if (appWrap) {\n                        var appEle = appWrap.querySelector('[data-id=\"' + _this.actionObj.clone.getAttribute('data-id') + '\"]');\n                        if (appEle) {\n                            addClass([appEle], cls.EVENT_ACTION_CLASS);\n                        }\n                    }\n                });\n            }\n        });\n    };\n    DragAndDrop.prototype.getSelectedData = function () {\n        if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n            for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n                var element = _a[_i];\n                var eventGuid = element.getAttribute('data-guid');\n                var data = this.parent.eventBase.getEventByGuid(eventGuid);\n                this.multiData.push(extend({}, data, null, true));\n            }\n        }\n        return this.multiData;\n    };\n    DragAndDrop.prototype.drag = function (e) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide(true);\n        }\n        if ((!isNullOrUndefined(e.target)) && e.target.classList.contains(cls.DISABLE_DATES)) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventArgs = this.getPageCoordinates(e);\n        this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n        this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n        this.actionObj.target = e.target;\n        this.widthUptoCursorPoint = (this.widthUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute)) *\n                this.widthPerMinute : this.widthUptoCursorPoint;\n        this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n        this.heightUptoCursorPoint = (this.heightUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute)) *\n                this.heightPerMinute : this.heightUptoCursorPoint;\n        this.isAllDayDrag = (this.parent.activeViewOptions.timeScale.enable) ?\n            this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) :\n            this.actionObj.event[this.parent.eventFields.isAllDay];\n        if (this.isStepDragging && this.minDiff === 0) {\n            this.calculateMinutesDiff(eventObj);\n        }\n        if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n            var date = this.parent.getDateFromElement(this.actionObj.target);\n            if (!isNullOrUndefined(date)) {\n                var currentDate = util.resetTime(date);\n                var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n                this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n            }\n            else {\n                this.daysVariation = 0;\n            }\n        }\n        else {\n            this.daysVariation = 0;\n        }\n        if (this.parent.eventDragArea) {\n            var targetElement = eventArgs.target;\n            this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n            this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n            var currentTarget = closest(targetElement, '.' + cls.ROOT);\n            if (!currentTarget) {\n                this.actionObj.clone.style.height = '';\n                this.actionObj.clone.style.width = '';\n            }\n            else {\n                if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n                    this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n                }\n            }\n        }\n        this.updateScrollPosition(e);\n        this.updateNavigatingPosition(e);\n        this.updateDraggingDateTime(e);\n        var dragArgs = {\n            data: eventObj, event: e, element: this.actionObj.element, startTime: this.actionObj.start,\n            endTime: this.actionObj.end, selectedData: this.updatedData\n        };\n        if (this.parent.group.resources.length > 0) {\n            dragArgs.groupIndex = this.actionObj.groupIndex;\n        }\n        this.parent.trigger(events.drag, dragArgs);\n    };\n    DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n        if (this.parent.enableRtl) {\n            this.minDiff =\n                ((this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute) * this.actionObj.interval;\n        }\n        else {\n            this.minDiff = (this.widthUptoCursorPoint / this.widthPerMinute) * this.actionObj.interval;\n        }\n        var startDate = eventObj[this.parent.eventFields.startTime];\n        var startTime = this.parent.activeView.renderDates[0];\n        var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n        if (startEndHours.startHour.getTime() > startDate.getTime()) {\n            this.minDiff = this.minDiff + ((startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE);\n        }\n    };\n    DragAndDrop.prototype.dragStop = function (e) {\n        var _this = this;\n        this.isCursorAhead = false;\n        this.removeCloneElementClasses();\n        this.removeCloneElement();\n        clearInterval(this.actionObj.navigationInterval);\n        this.actionObj.navigationInterval = null;\n        clearInterval(this.actionObj.scrollInterval);\n        this.actionObj.scrollInterval = null;\n        this.actionClass('removeClass');\n        this.parent.uiStateValues.action = false;\n        this.actionObj.action = null;\n        if (this.isAllowDrop(e)) {\n            return;\n        }\n        var target = ((!e.target.classList.contains('e-work-cells') && this.parent.cellTemplate) ?\n            closest(e.target, '.e-work-cells') : e.target);\n        var dragArgs = {\n            cancel: false, data: this.getChangedData(this.updatedData), selectedData: this.updatedData,\n            event: e, element: this.actionObj.element, target: target\n        };\n        this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel) {\n                return;\n            }\n            if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit\n                && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\n                _this.parent.crudModule.crudObj.isCrudAction = true;\n                _this.parent.crudModule.crudObj.sourceEvent =\n                    [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n                var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n                _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n            }\n            _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n        });\n        this.updatedData = [];\n        this.multiData = [];\n        this.isMultiSelect = false;\n        this.parent.selectedElements = [];\n    };\n    DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n        var _this = this;\n        if (this.actionObj.navigation.enable) {\n            var currentDate_1 = this.parent.getCurrentTime();\n            if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n                this.actionObj.navigationInterval = window.setInterval(function () {\n                    if (currentDate_1) {\n                        var crtDate = _this.parent.getCurrentTime();\n                        var end = crtDate.getSeconds();\n                        var start = currentDate_1.getSeconds() + (_this.actionObj.navigation.timeDelay / 1000);\n                        start = (start >= 60) ? start - 60 : start;\n                        if (start === end) {\n                            currentDate_1 = _this.parent.getCurrentTime();\n                            _this.viewNavigation(e);\n                            _this.updateDraggingDateTime(e);\n                        }\n                    }\n                }, this.actionObj.navigation.timeDelay);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n        if (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n            this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n            this.morePopupEventDragging(e);\n        }\n        else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n            this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n            this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n            this.timelineEventModule.getSlotDates();\n            this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n            this.calculateTimelineTime(e);\n        }\n        else {\n            if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n                this.calculateVerticalDate(e);\n            }\n            else {\n                this.calculateVerticalTime(e);\n            }\n        }\n    };\n    DragAndDrop.prototype.navigationWrapper = function () {\n        if (!this.parent.activeView.isTimelineView()) {\n            if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n                var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n                this.actionObj.index = (this.parent.activeView.renderDates.length < this.actionObj.index) ?\n                    this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n                var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n                if (!targetWrapper) {\n                    targetWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                    outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n                }\n                targetWrapper.appendChild(this.actionObj.clone);\n            }\n            else {\n                var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ?\n                    '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n                this.parent.element.querySelectorAll(wrapperClass)\n                    .item(this.actionObj.index).appendChild(this.actionObj.clone);\n                if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n                    var elementHeight = this.getAllDayEventHeight();\n                    var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n                    if (event_2[0].offsetHeight < elementHeight) {\n                        for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n                            var e = event_1[_i];\n                            e.style.height = ((elementHeight + 2) / 12) + 'em';\n                        }\n                    }\n                    this.actionObj.clone.style.height = formatUnit(elementHeight);\n                }\n                this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n            }\n        }\n        else {\n            var outWrapper = void 0;\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n            }\n            else {\n                outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n            }\n            if (!isNullOrUndefined(outWrapper)) {\n                var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n                if (!tarWrapper_1) {\n                    tarWrapper_1 = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                    outWrapper.appendChild(tarWrapper_1);\n                }\n                this.actionObj.cloneElement.forEach(function (ele) {\n                    tarWrapper_1.appendChild(ele);\n                });\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.viewNavigation = function (e) {\n        var navigationType;\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        if (dragArea && ((!this.scrollEdges.top && !this.scrollEdges.bottom) ||\n            closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n            if ((dragArea.scrollLeft === 0) &&\n                (Math.round(this.actionObj.X) <=\n                    Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'next' : 'previous';\n            }\n            else if ((Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth) &&\n                (Math.round(this.actionObj.X) >=\n                    Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'previous' : 'next';\n            }\n            if (navigationType) {\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n            }\n        }\n    };\n    DragAndDrop.prototype.morePopupEventDragging = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'td')))) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var td = closest(e.target, 'td');\n        if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n            return;\n        }\n        var dragStart = this.parent.getDateFromElement(td);\n        var dragEnd = new Date(dragStart.getTime());\n        dragEnd.setMilliseconds(eventDuration);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n        this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n        this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n        this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n        var eventContainer = td;\n        var eventWrapper;\n        if (this.parent.activeView.isTimelineView()) {\n            var rowIndex = closest(td, 'tr').rowIndex;\n            eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n        }\n        eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper);\n    };\n    DragAndDrop.prototype.calculateVerticalTime = function (e) {\n        var _this = this;\n        if (isNullOrUndefined(this.actionObj.target) ||\n            (this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr'))) ||\n            (!(closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS)) &&\n                !(closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)))) {\n            return;\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            this.swapDragging(e);\n        }\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventStart = eventObj[this.parent.eventFields.startTime];\n        var eventEnd = eventObj[this.parent.eventFields.endTime];\n        var eventDuration = eventEnd.getTime() - eventStart.getTime();\n        var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight)\n            * this.actionObj.cellHeight;\n        offsetTop = offsetTop < 0 ? 0 : offsetTop;\n        if (this.scrollEdges.top || this.scrollEdges.bottom) {\n            offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint +\n                this.actionObj.cellHeight + window.pageYOffset :\n                (dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset) +\n                    (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n            offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n            this.actionObj.clone.style.top = formatUnit(offsetTop);\n        }\n        var rowIndex = (this.parent.activeViewOptions.timeScale.enable) ? (offsetTop / this.actionObj.cellHeight) : 0;\n        var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n        var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n        var tr;\n        if (this.isAllDayDrag) {\n            tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n        }\n        else {\n            var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n            tr = trCollections[rowIndex];\n        }\n        var index;\n        if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) ||\n            closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            index = closest(this.actionObj.target, 'td').cellIndex;\n        }\n        var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n        this.actionObj.index = colIndex;\n        if (isNullOrUndefined(tr)) {\n            return;\n        }\n        var td = tr.children[colIndex];\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        var dragStart;\n        var dragEnd;\n        if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setMinutes(dragStart.getMinutes() + (diffInMinutes / heightPerMinute));\n            dragEnd = new Date(dragStart.getTime());\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n            }\n            else {\n                dragEnd.setMilliseconds(eventDuration);\n            }\n        }\n        else {\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setDate(dragStart.getDate() - this.daysVariation);\n            dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n            dragEnd = new Date(dragStart.getTime());\n            dragEnd.setMilliseconds(eventDuration);\n            if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n            }\n            this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n        }\n        this.actionObj.start = new Date(+dragStart);\n        this.actionObj.end = new Date(+dragEnd);\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        var dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n        for (var _i = 0, dynamicWrappers_1 = dynamicWrappers; _i < dynamicWrappers_1.length; _i++) {\n            var wrapper = dynamicWrappers_1[_i];\n            remove(wrapper);\n        }\n        if (this.multiData.length > 0) {\n            if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n                var targetCellTime_1 = parseInt((closest(this.actionObj.target, 'td')).getAttribute('data-date'), 10);\n                this.multiData.forEach(function (data) {\n                    _this.swagData.push(extend({}, data, null, true));\n                    if (data[_this.parent.eventFields.isAllDay]) {\n                        data[_this.parent.eventFields.startTime] =\n                            new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n                        var startTime = new Date(data[_this.parent.eventFields.startTime]);\n                        var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n                        data[_this.parent.eventFields.endTime] = endTime;\n                        data[_this.parent.eventFields.isAllDay] = false;\n                    }\n                });\n                this.startTime = targetCellTime_1;\n            }\n            if (this.isAllDayTarget && this.isAllDayDrag &&\n                !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n                this.multiData = this.swagData;\n                this.swagData = [];\n                var eventObj_1 = extend({}, this.actionObj.event, null, true);\n                this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n            }\n            var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\n                this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\n                var dayIndex = this.getDayIndex(this.updatedData[index_1]);\n                if (dayIndex >= 0) {\n                    var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\n                    this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\n                    this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\n                }\n                else {\n                    if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\n                        remove(this.actionObj.cloneElement[index_1]);\n                    }\n                }\n            }\n        }\n        else {\n            this.updateEventHeight(event);\n        }\n        this.updateTimePosition(this.actionObj.start, this.updatedData);\n    };\n    DragAndDrop.prototype.splitEvent = function (event) {\n        var eventFields = this.parent.eventFields;\n        var eventData = [];\n        var startTime = event[eventFields.startTime];\n        var endTime = event[eventFields.endTime];\n        if (util.resetTime(new Date(startTime.getTime())) < util.resetTime(new Date(endTime.getTime()))) {\n            var startReferenceDate = util.resetTime(new Date(startTime.getTime()));\n            var endReferenceDate = new Date(startReferenceDate.getTime());\n            for (var i = 0; startReferenceDate < new Date(endTime.getTime()); i++) {\n                endReferenceDate = new Date(endReferenceDate.setDate(startReferenceDate.getDate() + 1));\n                var eventObj = extend({}, event, null, true);\n                eventObj[eventFields.startTime] = new Date(startReferenceDate);\n                eventObj[eventFields.endTime] = new Date(endReferenceDate);\n                startReferenceDate = new Date(startReferenceDate.setDate(startReferenceDate.getDate() + 1));\n                eventData.push(eventObj);\n            }\n            var index = eventData.length - 1;\n            eventData[0][eventFields.startTime] = startTime;\n            eventData[index][eventFields.endTime] = endTime;\n        }\n        else {\n            eventData.push(event);\n        }\n        return eventData;\n    };\n    DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable &&\n            ((this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay]) ||\n                (!this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay]))) {\n            eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n        }\n        var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        if (eventObj[this.parent.eventFields.isAllDay]) {\n            var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n            var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n            var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n            eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n            eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n        }\n        else {\n            eventObj[this.parent.eventFields.startTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n            eventObj[this.parent.eventFields.endTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n        }\n        return eventObj;\n    };\n    DragAndDrop.prototype.getDayIndex = function (event) {\n        var eventObj = extend({}, event, null, true);\n        var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n        var query = '';\n        var wrapper = cls.DAY_WRAPPER_CLASS;\n        if (this.parent.activeViewOptions.timeScale.enable && (eventObj[this.parent.eventFields.isAllDay])) {\n            wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n        }\n        else {\n            wrapper = cls.WORK_CELLS_CLASS;\n        }\n        query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n        }\n        this.targetTd = this.parent.element.querySelector(query);\n        if (isNullOrUndefined(this.targetTd)) {\n            return -1;\n        }\n        return this.targetTd.cellIndex;\n    };\n    DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n        this.verticalEvent.initializeValues();\n        var datesCount = 0;\n        if (!this.parent.uiStateValues.isGroupAdaptive) {\n            for (var i = 0; i < this.actionObj.groupIndex; i++) {\n                datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n            }\n        }\n        var indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\n        var target = (this.parent.activeViewOptions.group.byDate &&\n            !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target))) ? true : false;\n        if (target || !this.parent.activeViewOptions.group.byDate) {\n            var dynamicIndex = -1;\n            var dayIndex = !this.parent.activeViewOptions.group.byDate ?\n                isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount\n                : this.parent.getIndexOfDate(this.verticalEvent.dateRender[indexGroup], util.resetTime(\n                // eslint-disable-next-line max-len\n                this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n            var splitEvents = this.splitEvent(event);\n            var events_1 = this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 ||\n                this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' ? [event] : splitEvents;\n            for (var i = 0; i < events_1.length; i++) {\n                if (i > 0) {\n                    var filterQuery = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(events_1[i][this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n                    if (this.parent.activeViewOptions.group.resources.length > 0) {\n                        filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n                    }\n                    var appWrap = this.parent.element.querySelector(filterQuery);\n                    if (appWrap) {\n                        dayIndex = dayIndex + 1;\n                        dynamicIndex = appWrap.cellIndex;\n                    }\n                    else {\n                        dayIndex = -1;\n                    }\n                }\n                if (dayIndex >= 0) {\n                    var record = this.verticalEvent.isSpannedEvent(events_1[i], dayIndex, indexGroup);\n                    var eStart = record[this.verticalEvent.fields.startTime];\n                    var eEnd = record[this.verticalEvent.fields.endTime];\n                    var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) :\n                        this.actionObj.element.offsetHeight;\n                    var topValue = this.parent.activeViewOptions.timeScale.enable ?\n                        this.verticalEvent.getTopValue(eStart, dayIndex, indexGroup) : this.actionObj.element.offsetTop;\n                    if (isNullOrUndefined(index)) {\n                        if (i === 0) {\n                            this.actionObj.clone.style.top = formatUnit(topValue);\n                            this.actionObj.clone.style.height = formatUnit(appHeight);\n                        }\n                        else {\n                            this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n                        }\n                    }\n                    else {\n                        var appWidth = this.actionObj.cellWidth;\n                        if (event[this.parent.eventFields.isAllDay]) {\n                            topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n                            appHeight = this.getAllDayEventHeight();\n                            var timeDiff = event[this.parent.eventFields.endTime].getTime() -\n                                event[this.parent.eventFields.startTime].getTime();\n                            var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n                            if (allDayDifference >= 0) {\n                                appWidth = (allDayDifference * this.actionObj.cellWidth);\n                            }\n                        }\n                        if (this.actionObj.cloneElement[index]) {\n                            if (i === 0) {\n                                this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n                                this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n                                this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n                                this.actionObj.cloneElement[index].style.left = formatUnit(0);\n                            }\n                            else {\n                                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    DragAndDrop.prototype.renderSpannedEvents = function (record, index, top, height) {\n        var startTime = record[this.parent.eventFields.startTime].getTime();\n        var endTime = record[this.parent.eventFields.endTime].getTime();\n        if (startTime !== endTime) {\n            var appointmentElement = this.verticalEvent.\n                createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\n            addClass([appointmentElement], [cls.CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\n            setStyleAttribute(appointmentElement, {\n                'width': '100%',\n                'height': height + 'px',\n                'top': top + 'px',\n                'border': '0px'\n            });\n            var appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n            appointmentWrap[index].appendChild(appointmentElement);\n        }\n    };\n    DragAndDrop.prototype.getRenderedDates = function () {\n        var _this = this;\n        var _a, _b;\n        var renderDates = this.parent.activeView.renderDates;\n        (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) { return +date; }));\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.parent.eventBase.slots = [];\n            var resources = this.parent.resourceBase.lastResourceLevel.\n                filter(function (res) { return res.groupIndex === _this.actionObj.groupIndex; });\n            renderDates = resources[0].renderDates;\n            (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) { return +date; }));\n        }\n        return renderDates;\n    };\n    DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n        this.parent.eventBase.slots = [];\n        var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n        var renderDates = this.getRenderedDates();\n        var events = this.parent.eventBase.splitEvent(event, renderDates);\n        var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n        }\n        var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n        if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n            var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n            this.appendCloneElement(this.getEventWrapper(cellIndex));\n            // eslint-disable-next-line max-len\n            this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.swapDragging = function (e) {\n        var colIndex = closest(this.actionObj.target, 'td').cellIndex;\n        if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n            addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = true;\n            var eventHeight = this.getAllDayEventHeight();\n            var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n            if (allDayElement[0].offsetHeight < eventHeight) {\n                for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n                    var element = allDayElement_1[_i];\n                    element.style.height = ((eventHeight + 2) / 12) + 'em';\n                }\n            }\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(this.actionObj.cellWidth),\n                height: formatUnit(eventHeight),\n                top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n            });\n        }\n        if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n            removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = false;\n            // eslint-disable-next-line max-len\n            var height = (this.actionObj.element.offsetHeight === 0) ? this.actionObj.height : this.actionObj.element.offsetHeight;\n            setStyleAttribute(this.actionObj.clone, {\n                left: formatUnit(0),\n                height: formatUnit(height),\n                width: formatUnit(this.actionObj.cellWidth)\n            });\n        }\n    };\n    DragAndDrop.prototype.calculateVerticalDate = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'tr'))) ||\n            (e.target && e.target.tagName === 'DIV')) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        if (isNullOrUndefined(this.parent.eventDragArea)) {\n            this.removeCloneElement();\n        }\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var td = closest(this.actionObj.target, 'td');\n        if (!isNullOrUndefined(td)) {\n            var tr = td.parentElement;\n            this.actionObj.index = (tr.rowIndex * tr.children.length) + td.cellIndex;\n            var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n            td = workCells[this.actionObj.index];\n            var currentDate = this.parent.getDateFromElement(td);\n            if (!isNullOrUndefined(currentDate)) {\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\n                    this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n                }\n                var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n                var dragStart = new Date(timeString.getTime());\n                var dragEnd = new Date(dragStart.getTime());\n                var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() -\n                    (util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime]))).getTime();\n                dragStart = new Date(dragStart.getTime() + startTimeDiff);\n                dragEnd = new Date(dragStart.getTime() + eventDuration);\n                this.actionObj.start = new Date(dragStart.getTime());\n                this.actionObj.end = new Date(dragEnd.getTime());\n            }\n        }\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n        for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n            var wrapper = eventWrappers_1[_i];\n            remove(wrapper);\n        }\n        if (this.multiData && this.multiData.length > 0) {\n            var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n            var startTimeDiff = startTime.getTime() - this.startTime;\n            if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n                startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n                startTimeDiff -= new Date(this.startTime).getMonth();\n                startTimeDiff += startTime.getMonth();\n            }\n            for (var index = 0; index < this.multiData.length; index++) {\n                this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n                if (this.parent.currentView === 'TimelineYear') {\n                    this.dynamicYearlyEventsRendering(this.updatedData[index]);\n                }\n                else {\n                    this.dynamicEventsRendering(this.updatedData[index]);\n                }\n            }\n        }\n        else {\n            if (this.parent.currentView === 'TimelineYear') {\n                this.dynamicYearlyEventsRendering(event);\n            }\n            else {\n                this.dynamicEventsRendering(event);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n        if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n        }\n        else {\n            var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n        }\n        eventObj[this.parent.eventFields.endTime] =\n            new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n        return eventObj;\n    };\n    DragAndDrop.prototype.calculateTimelineTime = function (e) {\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth :\n            parseInt(this.actionObj.clone.style.left, 10);\n        offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n        var rightOffset;\n        if (this.parent.enableRtl) {\n            rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n            this.actionObj.clone.style.right = formatUnit(rightOffset);\n        }\n        offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n        var colIndex = this.getColumnIndex(offsetLeft);\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\n        var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl &&\n            this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right &&\n            !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n        var leftVal = (this.parent.eventDragArea) ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n        if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n            this.isCursorAhead = true;\n        }\n        var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n        if (this.parent.enableRtl) {\n            cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) /\n                this.actionObj.cellWidth)) - 1;\n        }\n        if (this.cursorPointIndex < 0) {\n            this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n        }\n        var tr = this.parent.getContentTable().querySelector('tr');\n        var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n        index = index < 0 ? 0 : index;\n        var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) :\n            this.parent.getDateFromElement(tr.children[index]);\n        if (this.isStepDragging) {\n            var widthDiff = this.getWidthDiff(tr, index);\n            if (widthDiff !== 0) {\n                var timeDiff = Math.round(widthDiff / this.widthPerMinute);\n                eventStart.setMinutes(eventStart.getMinutes() + (timeDiff * this.actionObj.interval));\n                if (this.isCursorAhead || cursorDrag) {\n                    eventStart.setMilliseconds(-(eventDuration));\n                }\n                else {\n                    eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n                }\n            }\n            else {\n                eventStart = this.actionObj.start;\n            }\n        }\n        else {\n            if (this.isCursorAhead || cursorDrag) {\n                eventStart.setMinutes(eventStart.getMinutes() +\n                    (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n                eventStart.setMilliseconds(-(eventDuration));\n            }\n            else {\n                eventStart.setMinutes(eventStart.getMinutes() -\n                    (this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval)));\n            }\n        }\n        eventStart = this.calculateIntervalTime(eventStart);\n        if (this.isTimelineDayProcess) {\n            var eventSrt = eventObj[this.parent.eventFields.startTime];\n            eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n        }\n        if (this.parent.eventDragArea) {\n            var targetDate = this.parent.getDateFromElement(e.target);\n            if (!isNullOrUndefined(targetDate)) {\n                if (!this.parent.activeViewOptions.timeScale.enable || (this.parent.currentView === 'TimelineMonth')) {\n                    var eventSrt = eventObj[this.parent.eventFields.startTime];\n                    eventStart = new Date(targetDate.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds()));\n                }\n                else {\n                    eventStart = targetDate;\n                }\n            }\n        }\n        var eventEnd = new Date(eventStart.getTime());\n        eventEnd.setMilliseconds(eventDuration);\n        var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n        if (this.multiData.length > 0) {\n            var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (var i = 0; i < this.multiData.length; i++) {\n                this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n            }\n            eventsData = this.updatedData;\n        }\n        for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n            var events_2 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n            var eventData = events_2[0].data;\n            var startTime = this.timelineEventModule.getStartTime(events_2[0], eventData);\n            var endTime = this.timelineEventModule.getEndTime(events_2[0], eventData);\n            // eslint-disable-next-line max-len\n            var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count);\n            // eslint-disable-next-line max-len\n            var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n            day = day < 0 ? 0 : day;\n            var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n            var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n            if (this.parent.enableRtl) {\n                cloneElement.style.right = formatUnit(left);\n            }\n            else {\n                cloneElement.style.left = formatUnit(left);\n            }\n            if (!this.isMorePopupOpened) {\n                cloneElement.style.width = formatUnit(width);\n            }\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                this.calculateResourceGroupingPosition(e, cloneElement);\n            }\n            this.actionObj.start = new Date(eventStart.getTime());\n            this.actionObj.end = new Date(eventEnd.getTime());\n            this.updateTimePosition(this.actionObj.start, this.updatedData);\n        }\n    };\n    DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n        if (this.scrollEdges.left || this.scrollEdges.right) {\n            var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            if (this.parent.enableRtl) {\n                rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n                if (this.scrollEdges.right) {\n                    rightOffset = (rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth) -\n                        (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                else {\n                    rightOffset = rightOffset + this.widthUptoCursorPoint;\n                    if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n                        this.actionObj.clone.style.width =\n                            formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n                        rightOffset = (viewEle.scrollLeft - viewEle.scrollWidth);\n                    }\n                }\n                this.actionObj.clone.style.left = formatUnit(rightOffset);\n            }\n            else {\n                if (this.scrollEdges.left) {\n                    offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n                    if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n                        viewEle.scrollLeft = viewEle.scrollLeft - 1;\n                    }\n                    else if (this.actionObj.clone.offsetLeft === 0) {\n                        offsetLeft = viewEle.scrollLeft;\n                    }\n                }\n                else {\n                    offsetLeft = (viewEle.scrollLeft + viewEle.offsetWidth -\n                        this.actionObj.clone.offsetWidth) + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n                this.actionObj.clone.style.left = formatUnit(offsetLeft);\n            }\n        }\n        return offsetLeft;\n    };\n    DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n        var pages = this.scrollArgs.element.getBoundingClientRect();\n        if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n            var targetLeft = tr.children[index].offsetLeft;\n            var pageX = this.actionObj.pageX - pages.left;\n            if (this.parent.enableRtl) {\n                return (targetLeft + this.actionObj.cellWidth) - (this.scrollArgs.element.scrollLeft + pageX);\n            }\n            else {\n                return (this.scrollArgs.element.scrollLeft + pageX) - targetLeft;\n            }\n        }\n        return 0;\n    };\n    DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n        var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n        if (this.isHeaderRows) {\n            return index;\n        }\n        return this.getIndex(index);\n    };\n    DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n        var index = colIndex + cloneIndex;\n        if (this.isHeaderRows) {\n            var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n            return (index > dateLength - 1) ? dateLength - 1 : index;\n        }\n        return (index > tr.children.length - 1) ? tr.children.length - 1 : index;\n    };\n    DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n        var td = closest(e.target, '.e-work-cells');\n        if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n            var targetDate = this.parent.getDateFromElement(td);\n            if (this.isHeaderRows) {\n                var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n                targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n            }\n            var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n            if (this.isTimelineDayProcess) {\n                this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / (util.MS_PER_DAY)));\n            }\n            else {\n                var widthDiff = Math.floor((timeDiff / util.MS_PER_MINUTE) / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n                this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n                this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n            }\n        }\n        else {\n            this.cursorPointIndex = 0;\n        }\n    };\n    DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n        var translateY = util.getTranslateY(dragArea.querySelector('table'));\n        translateY = (isNullOrUndefined(translateY)) ? 0 : translateY;\n        var rowHeight = (this.parent.rowAutoHeight) ?\n            ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n        var rowIndex = Math.floor(Math.floor((this.actionObj.Y +\n            (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset))) -\n            dragArea.getBoundingClientRect().top) / rowHeight);\n        rowIndex = (rowIndex < 0) ? 0 : (rowIndex > trCollection.length - 1) ? trCollection.length - 1 : rowIndex;\n        this.actionObj.index = rowIndex;\n        var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n        var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper, cloneElement);\n        var td = closest(this.actionObj.target, 'td');\n        this.actionObj.groupIndex = (td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)))\n            ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n        var top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\n        if (this.parent.rowAutoHeight) {\n            var cursorElement = this.getCursorElement(e);\n            if (cursorElement) {\n                top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop :\n                    cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ?\n                        cursorElement.offsetParent.offsetTop : top;\n            }\n        }\n        cloneElement.style.top = formatUnit(top);\n    };\n    DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n        if (cloneElement === void 0) { cloneElement = null; }\n        cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n        var dragElement = document.querySelector(this.parent.eventDragArea);\n        if (this.parent.eventDragArea && dragElement) {\n            dragElement.appendChild(cloneElement);\n        }\n        else {\n            element.appendChild(cloneElement);\n        }\n    };\n    DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n        var eventWrapper;\n        if (isNullOrUndefined(isAllDayDrag)) {\n            isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n            eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n        }\n        else {\n            var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n            eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n            if (!eventWrapper) {\n                eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                targetWrapper.appendChild(eventWrapper);\n            }\n        }\n        return eventWrapper;\n    };\n    DragAndDrop.prototype.getAllDayEventHeight = function () {\n        var eventWrapper = createElement('div', { className: cls.APPOINTMENT_CLASS });\n        this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n        var eventHeight = eventWrapper.offsetHeight;\n        remove(eventWrapper);\n        return eventHeight;\n    };\n    DragAndDrop.prototype.isAllowDrop = function (e) {\n        if (!this.actionObj.excludeSelectors) {\n            return false;\n        }\n        var dropSelectors = this.actionObj.excludeSelectors.split(',');\n        var isAllowDrop = false;\n        for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n            var selector = dropSelectors_1[_i];\n            if (e.target.classList.contains(selector)) {\n                isAllowDrop = true;\n                break;\n            }\n        }\n        return isAllowDrop;\n    };\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name\n     */\n    DragAndDrop.prototype.getModuleName = function () {\n        return 'dragAndDrop';\n    };\n    return DragAndDrop;\n}(ActionBase));\nexport { DragAndDrop };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}